{"ast":null,"code":"import _regeneratorRuntime from \"/Users/yoji/Desktop/Software engineer/Job hunting 2022.11/tablecheck-demo/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/yoji/Desktop/Software engineer/Job hunting 2022.11/tablecheck-demo/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n\nvar _jsxFileName = \"/Users/yoji/Desktop/Software engineer/Job hunting 2022.11/tablecheck-demo/src/Pages/Listing/index.tsx\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useEffect, useState } from 'react';\nimport { SpinnerSize } from '@tablecheck/tablekit-spinner';\nimport { Link, useLocation } from 'react-router-dom';\nimport { ListingSpinner } from '../../styles/index';\nexport function Listing() {\n  _s();\n\n  var _this = this;\n\n  var _useState = useState([{\n    _id: '',\n    name: '',\n    slug: '',\n    cuisines: [],\n    search_image: ''\n  }]),\n      shopList = _useState[0],\n      setShopList = _useState[1];\n\n  var _useState2 = useState(false),\n      isLoading = _useState2[0],\n      setIsLoading = _useState2[1];\n\n  var location = useLocation();\n  var geoCoordinates = location.state;\n  var queryParams = new URLSearchParams(window.location.search);\n  var term = queryParams.get('term');\n\n  var getListing = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      var res, data;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              setIsLoading(function (prev) {\n                return !prev;\n              });\n              _context.next = 4;\n              return fetch(\"https://staging-snap.tablecheck.com/v2/shop_search?geo_latitude=\".concat(geoCoordinates.lat, \"&geo_longitude=\").concat(geoCoordinates.lon, \"&shop_universe_id=57e0b91744aea12988000001&locale=en&per_page=50\"));\n\n            case 4:\n              res = _context.sent;\n\n              if (!(res.status !== 200)) {\n                _context.next = 8;\n                break;\n              }\n\n              alert('Error happened. Please try again later.');\n              throw new Error('Error happened. Please try again later.');\n\n            case 8:\n              _context.next = 10;\n              return res.json();\n\n            case 10:\n              data = _context.sent;\n              setShopList(data.shops);\n              setIsLoading(function (prev) {\n                return !prev;\n              });\n              _context.next = 18;\n              break;\n\n            case 15:\n              _context.prev = 15;\n              _context.t0 = _context[\"catch\"](0);\n              console.error(_context.t0);\n\n            case 18:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 15]]);\n    }));\n\n    return function getListing() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var updateListing = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n      var res, data;\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              setIsLoading(function (prev) {\n                return !prev;\n              });\n              _context2.next = 4;\n              return fetch(\"https://staging-snap.tablecheck.com/v2/autocomplete?locale=en&shop_universe_id=57e0b91744aea12988000001&text=\".concat(term));\n\n            case 4:\n              res = _context2.sent;\n\n              if (!(res.status !== 200)) {\n                _context2.next = 8;\n                break;\n              }\n\n              alert('Error happened. Please try again later.');\n              throw new Error('Error happened. Please try again later.');\n\n            case 8:\n              _context2.next = 10;\n              return res.json();\n\n            case 10:\n              data = _context2.sent;\n              geoCoordinates = data.locations[0].payload.geo;\n              getListing();\n              setIsLoading(function (prev) {\n                return !prev;\n              });\n              _context2.next = 19;\n              break;\n\n            case 16:\n              _context2.prev = 16;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.error(_context2.t0);\n\n            case 19:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 16]]);\n    }));\n\n    return function updateListing() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    if (!term) {\n      getListing();\n    } else {\n      updateListing(); // make the url with query loadable\n    }\n  }, [term]);\n  return __jsx(React.Fragment, null, isLoading ? __jsx(ListingSpinner, {\n    size: SpinnerSize.Large,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 9\n    }\n  }) : __jsx(ListingWrapper, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }\n  }, shopList.map(function (shop) {\n    return __jsx(Link, {\n      to: shop.slug,\n      key: shop._id,\n      style: {\n        display: 'block',\n        marginBottom: '10px'\n      },\n      state: shop.slug,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 13\n      }\n    }, __jsx(\"div\", {\n      style: {\n        display: 'flex'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 15\n      }\n    }, __jsx(\"div\", {\n      style: {\n        width: '200px',\n        height: '120px'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 17\n      }\n    }, __jsx(\"img\", {\n      src: shop.search_image,\n      alt: \"thumbnail\",\n      style: {\n        width: '100%',\n        height: '100%',\n        objectFit: 'cover'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 19\n      }\n    })), __jsx(\"div\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 17\n      }\n    }, __jsx(\"h3\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 19\n      }\n    }, \" \", shop.name), shop.cuisines.map(function (cuisine, idx) {\n      return __jsx(\"span\", {\n        key: idx,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 21\n        }\n      }, cuisine, \", \");\n    }))));\n  })));\n}\n\n_s(Listing, \"C28yWbVNEs34VXBUvOolS5GOGDg=\", false, function () {\n  return [useLocation];\n});\n\n_c = Listing;\n\nvar _c;\n\n$RefreshReg$(_c, \"Listing\");","map":{"version":3,"names":["useEffect","useState","SpinnerSize","Link","useLocation","ListingSpinner","Listing","_id","name","slug","cuisines","search_image","shopList","setShopList","isLoading","setIsLoading","location","geoCoordinates","state","queryParams","URLSearchParams","window","search","term","get","getListing","prev","fetch","lat","lon","res","status","alert","Error","json","data","shops","console","error","updateListing","locations","payload","geo","Large","map","shop","display","marginBottom","width","height","objectFit","cuisine","idx"],"sources":["/Users/yoji/Desktop/Software engineer/Job hunting 2022.11/tablecheck-demo/src/Pages/Listing/index.tsx"],"sourcesContent":["import { useEffect, useState } from 'react'\nimport { SpinnerSize } from '@tablecheck/tablekit-spinner'\nimport { Link, useLocation } from 'react-router-dom'\nimport { ListingSpinner } from '../../styles/index'\n\ntype ShopList = {\n  _id: string\n  name: string\n  slug: string\n  cuisines: string[]\n  search_image: string\n}\n\ntype Geo = {\n  lat: string\n  lon: string\n}\n\nexport function Listing(): JSX.Element {\n  const [shopList, setShopList] = useState<ShopList[]>([\n    {\n      _id: '',\n      name: '',\n      slug: '',\n      cuisines: [],\n      search_image: '',\n    },\n  ])\n\n  const [isLoading, setIsLoading] = useState(false)\n\n  const location = useLocation()\n  let geoCoordinates = location.state as Geo\n\n  const queryParams = new URLSearchParams(window.location.search)\n  const term = queryParams.get('term')\n\n  const getListing = async () => {\n    try {\n      setIsLoading((prev) => !prev)\n      const res = await fetch(\n        `https://staging-snap.tablecheck.com/v2/shop_search?geo_latitude=${geoCoordinates.lat}&geo_longitude=${geoCoordinates.lon}&shop_universe_id=57e0b91744aea12988000001&locale=en&per_page=50`,\n      )\n      if (res.status !== 200) {\n        alert('Error happened. Please try again later.')\n        throw new Error('Error happened. Please try again later.')\n      }\n      const data = await res.json()\n      setShopList(data.shops)\n      setIsLoading((prev) => !prev)\n    } catch (e) {\n      console.error(e)\n    }\n  }\n\n  const updateListing = async () => {\n    try {\n      setIsLoading((prev) => !prev)\n      const res = await fetch(\n        `https://staging-snap.tablecheck.com/v2/autocomplete?locale=en&shop_universe_id=57e0b91744aea12988000001&text=${term}`,\n      )\n      if (res.status !== 200) {\n        alert('Error happened. Please try again later.')\n        throw new Error('Error happened. Please try again later.')\n      }\n      const data = await res.json()\n      geoCoordinates = data.locations[0].payload.geo\n      getListing()\n      setIsLoading((prev) => !prev)\n    } catch (e) {\n      console.error(e)\n    }\n  }\n\n  useEffect(() => {\n    if (!term) {\n      getListing()\n    } else {\n      updateListing() // make the url with query loadable\n    }\n  }, [term])\n\n  return (\n    <>\n      {isLoading ? (\n        <ListingSpinner size={SpinnerSize.Large} />\n      ) : (\n        <ListingWrapper>\n          {shopList.map((shop) => (\n            <Link\n              to={shop.slug}\n              key={shop._id}\n              style={{ display: 'block', marginBottom: '10px' }}\n              state={shop.slug}\n            >\n              <div style={{ display: 'flex' }}>\n                <div style={{ width: '200px', height: '120px' }}>\n                  <img\n                    src={shop.search_image}\n                    alt=\"thumbnail\"\n                    style={{\n                      width: '100%',\n                      height: '100%',\n                      objectFit: 'cover',\n                    }}\n                  />\n                </div>\n                <div>\n                  <h3> {shop.name}</h3>\n                  {shop.cuisines.map((cuisine, idx) => (\n                    <span key={idx}>{cuisine}, </span>\n                  ))}\n                </div>\n              </div>\n            </Link>\n          ))}\n        </ListingWrapper>\n      )}\n    </>\n  )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}