{"ast":null,"code":"import _regeneratorRuntime from \"/Users/yoji/Desktop/Software engineer/Job hunting 2022.11/tablecheck-demo/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/yoji/Desktop/Software engineer/Job hunting 2022.11/tablecheck-demo/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n\nvar _jsxFileName = \"/Users/yoji/Desktop/Software engineer/Job hunting 2022.11/tablecheck-demo/src/Pages/Listing/index.tsx\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useEffect, useState } from 'react';\nimport { Link, useLocation, Outlet } from 'react-router-dom'; // TODOs:\n// - fix the geoCoordinates type\n// - add loader\n// - what is the red colon? name:, slug:\n\nexport function Listing() {\n  _s();\n\n  var _this = this;\n\n  var _useState = useState([{\n    _id: '',\n    name: '',\n    slug: '',\n    cuisines: [],\n    search_image: ''\n  }]),\n      shopList = _useState[0],\n      setShopList = _useState[1];\n\n  var location = useLocation();\n  var geoCoordinates = location.state;\n  console.log('geo', geoCoordinates);\n  var queryParams = new URLSearchParams(window.location.search);\n  var term = queryParams.get('term');\n\n  var getListing = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      var res, data;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return fetch(\"https://staging-snap.tablecheck.com/v2/shop_search?geo_latitude=\".concat(geoCoordinates.lat, \"&geo_longitude=\").concat(geoCoordinates.lon, \"&shop_universe_id=57e0b91744aea12988000001&locale=en&per_page=50\"));\n\n            case 3:\n              res = _context.sent;\n\n              if (!(res.status !== 200)) {\n                _context.next = 7;\n                break;\n              }\n\n              alert('Error happened. Please try again later.');\n              throw new Error('Error happened. Please try again later.');\n\n            case 7:\n              _context.next = 9;\n              return res.json();\n\n            case 9:\n              data = _context.sent;\n              console.log(data);\n              setShopList(data.shops);\n              _context.next = 17;\n              break;\n\n            case 14:\n              _context.prev = 14;\n              _context.t0 = _context[\"catch\"](0);\n              console.error(_context.t0);\n\n            case 17:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 14]]);\n    }));\n\n    return function getListing() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var updateListing = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n      var res, data;\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return fetch(\"https://staging-snap.tablecheck.com/v2/autocomplete?locale=en&shop_universe_id=57e0b91744aea12988000001&text=\".concat(term));\n\n            case 3:\n              res = _context2.sent;\n              _context2.next = 6;\n              return res.json();\n\n            case 6:\n              data = _context2.sent;\n              geoCoordinates = data.locations[0].payload.geo;\n              getListing();\n              _context2.next = 14;\n              break;\n\n            case 11:\n              _context2.prev = 11;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.error(_context2.t0);\n\n            case 14:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 11]]);\n    }));\n\n    return function updateListing() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    if (!term) {\n      getListing();\n    } else {\n      updateListing(); // make the url with query loadable\n    }\n  }, [term]);\n  return __jsx(React.Fragment, null, shopList.map(function (shop) {\n    return __jsx(Link, {\n      to: shop.slug,\n      key: shop._id,\n      style: {\n        display: 'block',\n        marginBottom: '10px'\n      },\n      state: shop.slug,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }\n    }, __jsx(\"div\", {\n      style: {\n        display: 'flex'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 11\n      }\n    }, __jsx(\"div\", {\n      style: {\n        width: '200px',\n        height: '120px'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 13\n      }\n    }, __jsx(\"img\", {\n      src: shop.search_image,\n      alt: \"thumbnail\",\n      style: {\n        width: '100%',\n        height: '100%',\n        objectFit: 'cover'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 15\n      }\n    })), __jsx(\"div\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 13\n      }\n    }, __jsx(\"h3\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 15\n      }\n    }, \" \", shop.name), shop.cuisines.map(function (cuisine, idx) {\n      return __jsx(\"span\", {\n        key: idx,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 17\n        }\n      }, cuisine, \", \");\n    }))));\n  }), __jsx(Outlet, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }\n  }));\n}\n\n_s(Listing, \"W1hUIfraFSmWRE42lEQWYen0fu8=\", false, function () {\n  return [useLocation];\n});\n\n_c = Listing;\n\nvar _c;\n\n$RefreshReg$(_c, \"Listing\");","map":{"version":3,"names":["useEffect","useState","Link","useLocation","Outlet","Listing","_id","name","slug","cuisines","search_image","shopList","setShopList","location","geoCoordinates","state","console","log","queryParams","URLSearchParams","window","search","term","get","getListing","fetch","lat","lon","res","status","alert","Error","json","data","shops","error","updateListing","locations","payload","geo","map","shop","display","marginBottom","width","height","objectFit","cuisine","idx"],"sources":["/Users/yoji/Desktop/Software engineer/Job hunting 2022.11/tablecheck-demo/src/Pages/Listing/index.tsx"],"sourcesContent":["import { Helmet } from 'react-helmet'\nimport { useTranslation } from 'react-i18next'\nimport { PageWrapper, PageContent, Headline, PageImage } from 'Layouts'\nimport { Button } from '@tablecheck/tablekit-button'\nimport { Input } from '@tablecheck/tablekit-input'\n\nimport { HomeHeadline, HomeWrapper } from './styles'\nimport { useEffect, useState } from 'react'\nimport { Link, useLocation, Outlet } from 'react-router-dom'\n\n// TODOs:\n// - fix the geoCoordinates type\n// - add loader\n// - what is the red colon? name:, slug:\n\ntype ShopList = {\n  _id: string\n  name: string\n  slug: string\n  cuisines: string[]\n  search_image: string\n}\n\nexport function Listing(): JSX.Element {\n  const [shopList, setShopList] = useState<ShopList[]>([\n    {\n      _id: '',\n      name: '',\n      slug: '',\n      cuisines: [],\n      search_image: '',\n    },\n  ])\n\n  const location = useLocation()\n  let geoCoordinates: any = location.state\n  console.log('geo', geoCoordinates)\n\n  const queryParams = new URLSearchParams(window.location.search)\n  const term = queryParams.get('term')\n\n  const getListing = async () => {\n    try {\n      const res = await fetch(\n        `https://staging-snap.tablecheck.com/v2/shop_search?geo_latitude=${geoCoordinates.lat}&geo_longitude=${geoCoordinates.lon}&shop_universe_id=57e0b91744aea12988000001&locale=en&per_page=50`,\n      )\n      if (res.status !== 200) {\n        alert('Error happened. Please try again later.')\n        throw new Error('Error happened. Please try again later.')\n      }\n      const data = await res.json()\n      console.log(data)\n      setShopList(data.shops)\n    } catch (e) {\n      console.error(e)\n    }\n  }\n\n  const updateListing = async () => {\n    try {\n      const res = await fetch(\n        `https://staging-snap.tablecheck.com/v2/autocomplete?locale=en&shop_universe_id=57e0b91744aea12988000001&text=${term}`,\n      )\n      const data = await res.json()\n      geoCoordinates = data.locations[0].payload.geo\n      getListing()\n    } catch (e) {\n      console.error(e)\n    }\n  }\n\n  useEffect(() => {\n    if (!term) {\n      getListing()\n    } else {\n      updateListing() // make the url with query loadable\n    }\n  }, [term])\n\n  return (\n    <>\n      {shopList.map((shop) => (\n        <Link\n          to={shop.slug}\n          key={shop._id}\n          style={{ display: 'block', marginBottom: '10px' }}\n          state={shop.slug}\n        >\n          <div style={{ display: 'flex' }}>\n            <div style={{ width: '200px', height: '120px' }}>\n              <img\n                src={shop.search_image}\n                alt=\"thumbnail\"\n                style={{ width: '100%', height: '100%', objectFit: 'cover' }}\n              />\n            </div>\n            <div>\n              <h3> {shop.name}</h3>\n              {shop.cuisines.map((cuisine, idx) => (\n                <span key={idx}>{cuisine}, </span>\n              ))}\n            </div>\n          </div>\n        </Link>\n      ))}\n      <Outlet />\n    </>\n  )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}